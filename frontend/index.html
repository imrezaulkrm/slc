<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Member Directory</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #f9f9f9;
    padding: 30px;
  }

  h2 {
    text-align: center;
    margin-bottom: 20px;
  }

  #searchContainer {
    text-align: center;
    margin-bottom: 20px;
  }

  #searchInput {
    padding: 10px;
    width: 300px;
    border-radius: 5px;
    border: 1px solid #ccc;
  }

  #membersContainer {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 15px;
  }

  .member-card {
    background-color: #fff;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0px 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s;
  }

  .member-card:hover {
    transform: scale(1.03);
  }

  .member-card h3 {
    margin: 0 0 10px 0;
    font-size: 18px;
    color: #333;
  }

  .member-card p {
    margin: 5px 0;
    color: #555;
    font-size: 14px;
  }

  .no-results {
    text-align: center;
    font-style: italic;
    color: #888;
    grid-column: 1/-1;
  }
</style>
</head>
<body>

<h2>Member Directory</h2>

<div id="searchContainer">
  <input type="text" id="searchInput" placeholder="Search by name or email" oninput="searchMembers()">
</div>

<div id="membersContainer">
  <!-- Member cards will appear here -->
</div>

<script>
async function fetchMembers(search="") {
  try {
    // Public API route (no token needed)
    let url = "http://localhost:5000/api/members/public";
    if(search) url += "?search=" + encodeURIComponent(search);

    const res = await fetch(url);
    const data = await res.json();
    return data;
  } catch(err) {
    console.error(err);
    return [];
  }
}

async function searchMembers() {
  const search = document.getElementById("searchInput").value.trim();
  const members = await fetchMembers(search);
  const container = document.getElementById("membersContainer");
  container.innerHTML = "";

  if(members.length === 0){
    container.innerHTML = `<p class="no-results">No members found.</p>`;
    return;
  }

  members.forEach(m => {
    const div = document.createElement("div");
    div.className = "member-card";
    div.innerHTML = `
      <h3>${m.name}</h3>
      <p><strong>Email:</strong> ${m.email || "N/A"}</p>
      <p><strong>Phone:</strong> ${m.phone_number || "N/A"}</p>
      <p><strong>District:</strong> ${m.district || "N/A"}</p>
      <p><strong>Status:</strong> ${m.status}</p>
    `;
    container.appendChild(div);
  });
}

// Initial load
searchMembers();
</script>

</body>
</html>
