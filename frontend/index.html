<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Member Search</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
  h2 { text-align: center; margin-bottom: 20px; }
  #searchInput { padding: 10px; width: 300px; display:block; margin: 0 auto 20px auto; border-radius:5px; border:1px solid #ccc; }
  #memberGrid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px,1fr));
    gap: 20px;
  }
  .memberCard {
    background: #fff;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    text-align: center;
  }
  .memberCard img { width: 100px; height:100px; border-radius:50%; object-fit:cover; margin-bottom:10px; }
  .noResult { grid-column:1/-1; text-align:center; font-weight:bold; color:#888; font-size:1.2em; }
</style>
</head>
<body>

<h2>Member Directory</h2>
<input type="text" id="searchInput" placeholder="Search by Name or Member ID" oninput="liveSearch()">

<div id="memberGrid"></div>

<script>
let members = [];

// Load members from backend
async function loadMembers() {
  try {
    const res = await fetch('http://localhost:5000/api/members/public');
    members = await res.json();
    renderMembers(members); // initially show all
  } catch(err) {
    console.error(err);
  }
}

// Render members in grid
function renderMembers(data) {
  const grid = document.getElementById('memberGrid');
  grid.innerHTML = '';
  if(data.length === 0){
    grid.innerHTML = '<p class="noResult">No members found.</p>';
    return;
  }

  data.forEach(m => {
    const card = document.createElement('div');
    card.className = 'memberCard';
    card.innerHTML = `
      <img src="${m.profile_pic || 'https://via.placeholder.com/100'}" alt="Profile Pic">
      <h3>${m.name}</h3>
      <p><strong>Member ID:</strong> ${m.member_id || '-'}</p>
      <p><strong>District:</strong> ${m.district || '-'}</p>
    `;
    grid.appendChild(card);
  });
}

// Live search function
function liveSearch() {
  const query = document.getElementById('searchInput').value.trim().toLowerCase();
  if(!query) {
    renderMembers(members); // show all if input empty
    return;
  }

  const filtered = members.filter(m => 
    (m.name && m.name.toLowerCase().includes(query)) || 
    (m.member_id && m.member_id.toLowerCase().includes(query))
  );

  renderMembers(filtered);
}

// Initial load
loadMembers();
</script>
</body>
</html>
